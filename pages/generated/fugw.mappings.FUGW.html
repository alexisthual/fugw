<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="fugw.mappings.FUGWSparse" href="fugw.mappings.FUGWSparse.html" /><link rel="prev" title="fugw.mappings" href="../mappings.html" />

    <!-- Generated with Sphinx 5.3.0 and Furo 2023.03.27 -->
        <title>fugw.mappings.FUGW - FUGW</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #232629;
  --color-code-foreground: #cccccc;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #232629;
  --color-code-foreground: #cccccc;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">FUGW</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">FUGW</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../auto_examples/index.html">Examples</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../auto_examples/00_basics/index.html">Basics</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../auto_examples/00_basics/plot_1_dense.html">Transport distributions using dense solvers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../auto_examples/00_basics/plot_2_1_lmds.html">Generate embeddings from mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../auto_examples/00_basics/plot_2_2_coarse_to_fine.html">Transport distributions using sparse solvers</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../auto_examples/01_brain_alignment/index.html">Brain alignment</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../auto_examples/01_brain_alignment/plot_1_aligning_brain_dense.html">Low-resolution surface alignment of 2 individuals with fMRI data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../auto_examples/01_brain_alignment/plot_2_aligning_brain_sparse.html">High-resolution surface alignment of 2 individuals with fMRI data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../auto_examples/01_brain_alignment/plot_3_aligning_low_res_volumes.html">Low-resolution volume alignment of 2 individuals with fMRI data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../auto_examples/01_brain_alignment/plot_4_aligning_high_res_volumes.html">High-resolution volume alignment of 2 individuals with fMRI data</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../auto_examples/02_miscellaneous/index.html">Miscellaneous</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../auto_examples/02_miscellaneous/plot_1_pearson_correlation.html">Monitor the Pearson correlation during training with callbacks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../auto_examples/02_miscellaneous/plot_2_simple_crossval.html">Using a validation set to monitor the convergence of the fugw loss</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../auto_examples/02_miscellaneous/plot_3_memory_usage_callback.html">Monitor memory usage at each BCD iteration with callbacks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../api_references.html">API references</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="../mappings.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fugw.mappings</span></code></a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">fugw.mappings.FUGW</a></li>
<li class="toctree-l3"><a class="reference internal" href="fugw.mappings.FUGWSparse.html">fugw.mappings.FUGWSparse</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../solvers.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fugw.solvers</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="fugw.solvers.FUGWSolver.html">fugw.solvers.FUGWSolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="fugw.solvers.FUGWSparseSolver.html">fugw.solvers.FUGWSparseSolver</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fugw.utils</span></code></a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/alexisthual/fugw">GitHub repository</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="fugw-mappings-fugw">
<h1>fugw.mappings.FUGW<a class="headerlink" href="#fugw-mappings-fugw" title="Permalink to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="fugw.mappings.FUGW">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fugw.mappings.</span></span><span class="sig-name descname"><span class="pre">FUGW</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'joint'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divergence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kl'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fugw.mappings.FUGW" title="Permalink to this definition">#</a></dt>
<dd><p>Class computing dense transport plans.</p>
<p class="rubric">Methods</p>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#fugw.mappings.FUGW.fit" title="fugw.mappings.FUGW.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>([source_features, target_features, ...])</p></td>
<td><p>Compute transport plan between source and target distributions using feature maps and geometries.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#fugw.mappings.FUGW.inverse_transform" title="fugw.mappings.FUGW.inverse_transform"><code class="xref py py-obj docutils literal notranslate"><span class="pre">inverse_transform</span></code></a>(target_features[, device])</p></td>
<td><p>Transport target feature maps using fitted OT plan.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#fugw.mappings.FUGW.transform" title="fugw.mappings.FUGW.transform"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform</span></code></a>(source_features[, id_reg, device])</p></td>
<td><p>Transport source feature maps using fitted OT plan.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="fugw.mappings.FUGW.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'joint'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divergence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kl'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fugw.mappings.FUGW.__init__" title="Permalink to this definition">#</a></dt>
<dd><p>Init FUGW problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>alpha: float, optional, defaults to 0.5</strong></dt><dd><p>Value in ]0, 1[, interpolates the relative importance of
the Wasserstein and the Gromov-Wasserstein losses
in the FUGW loss (see equation)</p>
</dd>
<dt><strong>rho: float or tuple of 2 floats, optional, defaults to 1</strong></dt><dd><p>Value in ]0, +inf[, controls the relative importance of
the marginal constraints. High values force the mass of
each point to be transported ;
low values allow for some mass loss</p>
</dd>
<dt><strong>eps: float, optional, defaults to 1e-2</strong></dt><dd><p>Value in ]0, +inf[, controls the relative importance of
the entropy loss</p>
</dd>
<dt><strong>reg_mode: “joint” or “independent”, optional, defaults to “joint”</strong></dt><dd><p>“joint”: use unbalanced-GW-like regularisation term
“independent”: use unbalanced-W-like regularisation term</p>
</dd>
<dt><strong>divergence: string, optional</strong></dt><dd><p>What divergence to use for the marginal contraints
and regularization. Can be “kl” or “l2”.
Defaults to “kl”.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>alpha: float</strong></dt><dd></dd>
<dt><strong>rho: float</strong></dt><dd></dd>
<dt><strong>eps: float</strong></dt><dd></dd>
<dt><strong>reg_mode: “joint” or “independent”</strong></dt><dd></dd>
<dt><strong>pi: numpy.ndarray or None</strong></dt><dd><p>Transport plan computed with <code class="docutils literal notranslate"><span class="pre">.fit()</span></code></p>
</dd>
<dt><strong>loss: dict of lists</strong></dt><dd><p>Dictionary containing the training loss and its unweighted
components for each step of the block-coordinate-descent
for which the FUGW loss was evaluated.
Keys are: “wasserstein”, “gromov_wasserstein”,
“marginal_constraint_dim1”, “marginal_constraint_dim2”,
“regularization”, “total”.
Values are float or None.</p>
</dd>
<dt><strong>loss_val: dict of lists</strong></dt><dd><p>Dictionary containing the validation loss and its unweighted
components for each step of the block-coordinate-descent
for which the FUGW loss was evaluated.
Values are float or None.</p>
</dd>
<dt><strong>loss_steps: list</strong></dt><dd><p>BCD steps at the end of which the FUGW loss was evaluated</p>
</dd>
<dt><strong>loss_times: list</strong></dt><dd><p>Elapsed time at the end of each BCD step for which the
FUGW loss was evaluated.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fugw.mappings.FUGW.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_geometry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_geometry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_features_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_features_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_geometry_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_geometry_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_plan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_duals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback_bcd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fugw.mappings.FUGW.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Compute transport plan between source and target distributions
using feature maps and geometries.
In our case, feature maps are fMRI contrast maps,
and geometries are that of the cortical meshes of individuals
under study.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>source_features: ndarray(n_features, n), optional</strong></dt><dd><p>Feature maps for source subject.
n_features is the number of contrast maps, it should
be the same for source and target data.
n is the number of nodes on the source graph, it
can be different from m, the number of nodes on the
target graph.
<strong>This array should be normalized</strong>, otherwise you will
run into computational errors.</p>
</dd>
<dt><strong>target_features: ndarray(n_features, m), optional</strong></dt><dd><p>Feature maps for target subject.
<strong>This array should be normalized</strong>, otherwise you will
run into computational errors.</p>
</dd>
<dt><strong>source_geometry: ndarray(n, n)</strong></dt><dd><p>Kernel matrix of anatomical distances
between nodes of source mesh
<strong>This array should be normalized</strong>, otherwise you will
run into computational errors.</p>
</dd>
<dt><strong>target_geometry: ndarray(m, m)</strong></dt><dd><p>Kernel matrix of anatomical distances
between nodes of target mesh
<strong>This array should be normalized</strong>, otherwise you will
run into computational errors.</p>
</dd>
<dt><strong>source_features_val: ndarray(n_features, n) or None</strong></dt><dd><p>Feature maps for source subject used for validation.
If None, source_features will be used instead.</p>
</dd>
<dt><strong>target_features_val: ndarray(n_features, m) or None</strong></dt><dd><p>Feature maps for target subject used for validation.
If None, target_features will be used instead.</p>
</dd>
<dt><strong>source_geometry_val: ndarray(n, n) or None</strong></dt><dd><p>Kernel matrix of anatomical distances
between nodes of source mesh used for validation.
If None, source_geometry will be used instead.</p>
</dd>
<dt><strong>target_geometry_val: ndarray(m, m) or None</strong></dt><dd><p>Kernel matrix of anatomical distances
between nodes of target mesh used for validation.
If None, target_geometry will be used instead.</p>
</dd>
<dt><strong>source_weights: ndarray(n) or None</strong></dt><dd><p>Distribution weights of source nodes.
Should sum to 1. If None, eahc node’s weight
will be set to 1 / n.</p>
</dd>
<dt><strong>target_weights: ndarray(n) or None</strong></dt><dd><p>Distribution weights of target nodes.
Should sum to 1. If None, eahc node’s weight
will be set to 1 / m.</p>
</dd>
<dt><strong>init_plan: ndarray(n, m) or None</strong></dt><dd><p>Transport plan to use at initialisation.
If None, an entropic initialization will be used.</p>
</dd>
<dt><strong>init_duals: tuple of [ndarray(n), ndarray(m)] or None</strong></dt><dd><p>Dual potentials to use at initialisation.</p>
</dd>
<dt><strong>solver: “sinkhorn” or “mm” or “ibpp”</strong></dt><dd><p>Solver to use.</p>
</dd>
<dt><strong>solver_params: fugw.solvers.utils.BaseSolver params</strong></dt><dd><p>Parameters given to the solver.</p>
</dd>
<dt><strong>callback_bcd: callable or None</strong></dt><dd><p>Callback function called at the end of each BCD step.
It will be called with the following arguments:</p>
<blockquote>
<div><ul class="simple">
<li><p>locals (dictionary containing all local variables)</p></li>
</ul>
</div></blockquote>
</dd>
<dt><strong>device: “auto” or torch.device</strong></dt><dd><p>if “auto”: use first available gpu if it’s available,
cpu otherwise.</p>
</dd>
<dt><strong>verbose: bool, optional, defaults to False</strong></dt><dd><p>Log solving process.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>self: FUGW class object</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fugw.mappings.FUGW.inverse_transform">
<span class="sig-name descname"><span class="pre">inverse_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fugw.mappings.FUGW.inverse_transform" title="Permalink to this definition">#</a></dt>
<dd><p>Transport target feature maps using fitted OT plan.
Use GPUs if available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>target_features: ndarray(n_samples, m) or ndarray(m)</strong></dt><dd><p>Contrast map for target subject</p>
</dd>
<dt><strong>device: “auto” or torch.device</strong></dt><dd><p>If “auto”: use first available GPU if it’s available,
CPU otherwise.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>transported_data: ndarray(n_samples, n) or ndarray(n)</dt><dd><p>Contrast map transported in source subject’s space</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fugw.mappings.FUGW.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_reg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fugw.mappings.FUGW.transform" title="Permalink to this definition">#</a></dt>
<dd><p>Transport source feature maps using fitted OT plan.
Use GPUs if available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>source_features: ndarray(n_samples, n) or ndarray(n)</strong></dt><dd><p>Contrast map for source subject</p>
</dd>
<dt><strong>id_reg: float, in the [0, 1] interval, defaults to 0</strong></dt><dd><p>If source/target share the same geometry,
interpolate the transport plan with the identity
using the provided coefficient.
A value of 1 (resp. 0) will rely solely on the identity
(resp. the transport plan).</p>
</dd>
<dt><strong>device: “auto” or torch.device</strong></dt><dd><p>If “auto”: use first available GPU if it’s available,
CPU otherwise.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>transported_data: ndarray(n_samples, m) or ndarray(m)</dt><dd><p>Contrast map transported in target subject’s space</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<div style='clear:both'></div></section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="fugw.mappings.FUGWSparse.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">fugw.mappings.FUGWSparse</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../mappings.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fugw.mappings</span></code></div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022-2024, the fugw team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">fugw.mappings.FUGW</a><ul>
<li><a class="reference internal" href="#fugw.mappings.FUGW"><code class="docutils literal notranslate"><span class="pre">FUGW</span></code></a><ul>
<li><a class="reference internal" href="#fugw.mappings.FUGW.__init__"><code class="docutils literal notranslate"><span class="pre">FUGW.__init__()</span></code></a></li>
<li><a class="reference internal" href="#fugw.mappings.FUGW.fit"><code class="docutils literal notranslate"><span class="pre">FUGW.fit()</span></code></a></li>
<li><a class="reference internal" href="#fugw.mappings.FUGW.inverse_transform"><code class="docutils literal notranslate"><span class="pre">FUGW.inverse_transform()</span></code></a></li>
<li><a class="reference internal" href="#fugw.mappings.FUGW.transform"><code class="docutils literal notranslate"><span class="pre">FUGW.transform()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/scripts/furo.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    </body>
</html>
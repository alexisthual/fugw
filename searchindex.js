Search.setIndex({"docnames": ["auto_examples/00_basics/index", "auto_examples/00_basics/plot_1_dense", "auto_examples/00_basics/plot_2_1_lmds", "auto_examples/00_basics/plot_2_2_coarse_to_fine", "auto_examples/00_basics/sg_execution_times", "auto_examples/01_brain_alignment/index", "auto_examples/01_brain_alignment/plot_1_aligning_brain_dense", "auto_examples/01_brain_alignment/plot_2_aligning_brain_sparse", "auto_examples/01_brain_alignment/plot_3_aligning_low_res_volumes", "auto_examples/01_brain_alignment/plot_4_aligning_high_res_volumes", "auto_examples/01_brain_alignment/sg_execution_times", "auto_examples/02_miscellaneous/index", "auto_examples/02_miscellaneous/plot_1_simple_crossval", "auto_examples/02_miscellaneous/plot_2_memory_usage_callback", "auto_examples/02_miscellaneous/sg_execution_times", "auto_examples/index", "index", "pages/api_references", "pages/contributing", "pages/generated/fugw.mappings.FUGW", "pages/generated/fugw.mappings.FUGWSparse", "pages/generated/fugw.solvers.FUGWSolver", "pages/generated/fugw.solvers.FUGWSparseSolver", "pages/introduction", "pages/mappings", "pages/solvers", "pages/utils"], "filenames": ["auto_examples/00_basics/index.rst", "auto_examples/00_basics/plot_1_dense.rst", "auto_examples/00_basics/plot_2_1_lmds.rst", "auto_examples/00_basics/plot_2_2_coarse_to_fine.rst", "auto_examples/00_basics/sg_execution_times.rst", "auto_examples/01_brain_alignment/index.rst", "auto_examples/01_brain_alignment/plot_1_aligning_brain_dense.rst", "auto_examples/01_brain_alignment/plot_2_aligning_brain_sparse.rst", "auto_examples/01_brain_alignment/plot_3_aligning_low_res_volumes.rst", "auto_examples/01_brain_alignment/plot_4_aligning_high_res_volumes.rst", "auto_examples/01_brain_alignment/sg_execution_times.rst", "auto_examples/02_miscellaneous/index.rst", "auto_examples/02_miscellaneous/plot_1_simple_crossval.rst", "auto_examples/02_miscellaneous/plot_2_memory_usage_callback.rst", "auto_examples/02_miscellaneous/sg_execution_times.rst", "auto_examples/index.rst", "index.rst", "pages/api_references.rst", "pages/contributing.md", "pages/generated/fugw.mappings.FUGW.rst", "pages/generated/fugw.mappings.FUGWSparse.rst", "pages/generated/fugw.solvers.FUGWSolver.rst", "pages/generated/fugw.solvers.FUGWSparseSolver.rst", "pages/introduction.md", "pages/mappings.rst", "pages/solvers.rst", "pages/utils.rst"], "titles": ["Basics", "Transport distributions using dense solvers", "Generate embeddings from mesh", "Transport distributions using sparse solvers", "Computation times", "Brain alignment", "Low-resolution surface alignment of 2 individuals with fMRI data", "High-resolution surface alignment of 2 individuals with fMRI data", "Low-resolution volume alignment of 2 individuals with fMRI data", "High-resolution volume alignment of 2 individuals with fMRI data", "Computation times", "Miscellaneous", "Using a validation set to monitor the convergence of the fugw loss", "Monitor memory usage at each BCD iteration with callbacks", "Computation times", "Examples", "Fused Unbalanced Gromov-Wasserstein for Python", "API references", "Contributing", "fugw.mappings.FUGW", "fugw.mappings.FUGWSparse", "fugw.solvers.FUGWSolver", "fugw.solvers.FUGWSparseSolver", "Introduction", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">fugw.mappings</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">fugw.solvers</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">fugw.utils</span></code>"], "terms": {"thi": [0, 1, 2, 3, 5, 6, 7, 8, 9, 11, 12, 13, 15, 17, 19, 20, 21, 22, 23, 24], "section": [0, 11, 15], "cover": [0, 5, 7, 15], "idea": [0, 15], "behind": [0, 7, 15], "packag": [0, 1, 3, 6, 7, 8, 9, 11, 12, 13, 15, 16, 17], "we": [0, 1, 2, 3, 6, 7, 8, 9, 12, 13, 15, 18, 21, 22, 23], "introduc": [0, 15], "fuse": [0, 15, 23], "unbalanc": [0, 15, 19, 20, 23], "gromov": [0, 15, 19, 20, 23], "wasserstein": [0, 1, 3, 6, 7, 15, 19, 20, 21, 22, 23], "loss": [0, 1, 3, 6, 7, 8, 9, 11, 13, 14, 15, 19, 20, 21, 22, 23], "its": [0, 6, 15, 19, 20, 21, 22], "dens": [0, 3, 4, 6, 7, 8, 9, 12, 13, 15, 19, 21], "solver": [0, 4, 6, 7, 8, 9, 12, 13, 15, 16, 17, 19, 20], "Then": [0, 15, 21, 22], "show": [0, 1, 2, 3, 6, 7, 8, 9, 12, 13, 15], "how": [0, 2, 6, 7, 15, 23], "larg": [0, 2, 15], "low": [0, 5, 7, 9, 10, 12, 15, 19, 20], "rank": [0, 15], "geometri": [0, 1, 8, 9, 12, 13, 15, 19, 20, 21, 22, 23], "can": [0, 1, 2, 3, 6, 7, 8, 9, 11, 13, 15, 16, 18, 19, 20, 23], "approxim": [0, 2, 6, 7, 15, 20, 23], "comput": [0, 2, 3, 8, 9, 12, 13, 15, 17, 19, 20, 21, 22, 23], "an": [0, 2, 5, 6, 7, 15, 16, 21, 22, 23], "embed": [0, 1, 3, 4, 7, 9, 15, 20], "result": [0, 7, 12, 15, 24], "much": [0, 3, 6, 7, 12, 15, 24], "less": [0, 1, 7, 15], "memori": [0, 1, 2, 3, 6, 7, 8, 9, 11, 12, 14, 15], "usag": [0, 1, 2, 3, 6, 7, 8, 9, 11, 12, 14, 15], "final": [0, 1, 2, 3, 6, 15, 23], "us": [0, 2, 4, 8, 9, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24], "combin": [0, 15, 21, 22], "spars": [0, 1, 4, 7, 9, 13, 15, 20, 22], "fugw": [0, 1, 2, 3, 6, 7, 8, 9, 11, 13, 14, 15, 16, 17, 23], "transport": [0, 4, 6, 7, 8, 9, 13, 15, 16, 17, 19, 20, 21, 22, 23], "distribut": [0, 2, 4, 7, 13, 15, 17, 19, 20, 21, 22, 23], "gener": [0, 1, 3, 4, 6, 7, 8, 9, 12, 13, 15], "from": [0, 1, 3, 4, 6, 7, 8, 9, 12, 13, 15, 17, 19, 20, 23, 26], "mesh": [0, 4, 6, 7, 15, 19, 20], "go": [1, 2, 3, 6, 7, 8, 9, 12, 13], "end": [1, 2, 3, 6, 7, 8, 9, 12, 13, 19, 20, 21, 22], "download": [1, 2, 3, 6, 7, 8, 9, 12, 13], "full": [1, 2, 3, 6, 7, 8, 9, 12, 13], "exampl": [1, 2, 3, 6, 7, 8, 9, 12, 13], "code": [1, 2, 3, 6, 7, 8, 9, 12, 13, 23], "In": [1, 2, 3, 6, 7, 8, 9, 12, 13, 16, 19, 20, 23], "sampl": [1, 2, 3, 7, 13, 21, 22], "2": [1, 2, 3, 4, 5, 10, 12, 13, 15, 19, 20, 21, 22, 23, 24], "toi": [1, 3], "align": [1, 2, 3, 10, 12, 16, 17, 23], "between": [1, 2, 3, 6, 7, 8, 9, 12, 13, 17, 19, 20, 21, 22, 23], "them": [1, 3, 6, 7, 16, 23, 24], "ar": [1, 3, 6, 7, 11, 12, 13, 15, 19, 20, 21, 22, 23], "typic": [1, 3, 7], "when": [1, 2, 3, 8, 9, 12, 18, 24], "both": [1, 3, 8, 9, 12, 17], "have": [1, 2, 3, 6, 7, 9, 16, 23], "than": [1, 3, 7], "10k": [1, 3, 7], "point": [1, 2, 3, 8, 19, 20, 21, 22, 23], "import": [1, 2, 3, 6, 7, 8, 9, 12, 13, 19, 20], "matplotlib": [1, 2, 3, 6, 7, 8, 9, 12, 13], "pyplot": [1, 2, 3, 6, 7, 8, 9, 12, 13], "plt": [1, 2, 3, 6, 7, 8, 9, 12, 13], "numpi": [1, 2, 3, 6, 7, 8, 9, 12, 19, 20], "np": [1, 2, 3, 6, 7, 8, 9, 12], "torch": [1, 2, 3, 6, 7, 9, 13, 19, 20, 21, 22], "util": [1, 3, 6, 7, 13, 17, 19, 20, 24], "_init_mock_distribut": [1, 3, 13], "collect": [1, 3, 6, 7], "linecollect": [1, 3], "manual_se": [1, 2, 3, 7, 13], "0": [1, 2, 3, 6, 7, 8, 9, 12, 13, 14, 16, 19, 20, 21, 22], "n_points_sourc": [1, 3, 13], "50": [1, 7, 12, 13], "n_points_target": [1, 3, 13], "40": [1, 3, 7, 9, 13], "n_features_train": [1, 3, 13], "n_features_test": [1, 3, 13], "let": [1, 2, 3, 6, 7, 8, 9, 13], "u": [1, 2, 3, 7, 13, 23], "random": [1, 2, 3, 7, 13], "train": [1, 3, 8, 9, 12, 13, 19, 20, 21], "data": [1, 2, 3, 5, 10, 12, 13, 15, 19, 20, 24], "sourc": [1, 2, 3, 6, 7, 8, 9, 12, 13, 19, 20, 21, 22], "target": [1, 3, 6, 7, 8, 9, 13, 19, 20, 21, 22], "_": [1, 3, 6, 8, 9, 12, 13], "source_features_train": [1, 3, 13], "source_geometri": [1, 6, 8, 12, 13, 19, 20], "source_embed": [1, 3], "target_features_train": [1, 3, 13], "target_geometri": [1, 6, 8, 12, 13, 19, 20], "target_embed": [1, 3], "shape": [1, 2, 3, 6, 7, 8, 9], "usr": [1, 3, 6, 7, 8, 9, 12, 13], "local": [1, 3, 6, 7, 8, 9, 12, 13, 19, 20, 21, 22], "lib": [1, 3, 6, 7, 8, 9, 12, 13], "python3": [1, 3, 6, 7, 8, 9, 12, 13], "8": [1, 3, 6, 7, 8, 9, 10, 12, 13, 14], "site": [1, 3, 6, 7, 8, 9, 12, 13], "wishart": [1, 3, 13], "py": [1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14], "253": [1, 3, 13], "userwarn": [1, 2, 3, 6, 7, 8, 9, 12, 13], "singular": [1, 3, 13], "detect": [1, 3, 6, 13], "size": [1, 2, 3, 6, 7, 8, 9, 13, 21, 22], "visual": [1, 3, 7], "featur": [1, 3, 8, 9, 12, 13, 19, 20, 21, 22, 23], "fig": [1, 2, 3, 6, 7, 8, 9, 12, 13], "figur": [1, 2, 3, 6, 7, 8, 9, 12, 13, 23], "figsiz": [1, 2, 3, 6, 7, 8, 9, 13], "4": [1, 3, 4, 5, 6, 7, 8, 9, 12, 13, 15, 16, 23], "ax": [1, 2, 3, 6, 7, 8, 9, 12, 13], "add_subplot": [1, 2, 3, 6, 7, 8, 9, 12, 13], "set_titl": [1, 2, 3, 6, 7, 8, 9, 12], "set_aspect": [1, 3], "equal": [1, 3, 23], "datalim": [1, 3], "scatter": [1, 2, 3, 8, 9, 12], "1": [1, 2, 3, 6, 7, 8, 9, 12, 13, 19, 20, 21, 22, 23], "label": [1, 3, 6, 7, 8, 12], "legend": [1, 3, 6, 7, 12], "And": [1, 3, 6, 7], "project": [1, 2, 6, 7, 8, 9, 12], "3d": [1, 2, 6, 7, 8, 9, 12], "ie": [1, 6, 21, 22, 23], "": [1, 2, 3, 6, 7, 8, 9, 13, 19, 20, 23], "15": [1, 2, 4, 6, 7, 8, 9], "should": [1, 2, 3, 6, 7, 13, 16, 19, 20, 23, 24], "normal": [1, 3, 8, 9, 12, 13, 19, 20], "befor": [1, 3, 6, 7, 13, 21, 22], "call": [1, 13, 17, 19, 20, 21, 22, 23, 25], "source_features_train_norm": [1, 3, 13], "linalg": [1, 3, 6, 7, 8, 9, 12, 13], "norm": [1, 3, 6, 7, 8, 9, 12, 13, 20], "dim": [1, 3, 7, 13], "reshap": [1, 3, 6, 7, 8, 9, 12, 13], "target_features_train_norm": [1, 3, 13], "source_geometry_norm": [1, 6, 8, 12, 13], "max": [1, 6, 8, 12, 13], "target_geometry_norm": [1, 6, 8, 12, 13], "defin": [1, 3, 12, 13], "optim": [1, 3, 6, 13, 16, 17], "problem": [1, 3, 13, 16, 17, 19, 20], "solv": [1, 3, 13, 19, 20, 21, 22], "alpha": [1, 3, 6, 7, 8, 9, 12, 13, 19, 20, 21, 22], "5": [1, 2, 3, 6, 7, 8, 9, 12, 13, 19, 20, 21, 22, 23], "rho": [1, 3, 6, 7, 8, 9, 12, 13, 19, 20], "1000": [1, 7, 9, 13, 21, 22], "ep": [1, 3, 6, 7, 8, 9, 12, 13, 19, 20, 21, 22], "1e": [1, 3, 6, 7, 8, 9, 12, 13, 19, 20, 21, 22], "now": [1, 2, 3, 6, 7, 8, 9, 12, 13, 23], "fit": [1, 2, 3, 6, 7, 8, 9, 12, 13, 17, 19, 20, 21, 22, 24], "plan": [1, 3, 6, 7, 13, 17, 19, 20, 21, 22, 23], "sinkhorn": [1, 6, 8, 9, 12, 13, 19, 21, 22, 23], "verbos": [1, 2, 3, 6, 7, 8, 9, 12, 13, 19, 20, 21, 22], "true": [1, 2, 3, 6, 7, 8, 9, 12, 13, 26], "17": [1, 3, 6, 7, 8, 9, 12, 13], "34": [1, 3, 6, 9, 23], "21": [1, 3], "valid": [1, 3, 6, 7, 8, 9, 11, 13, 14, 15, 19, 20, 21], "i": [1, 2, 3, 6, 7, 8, 9, 12, 13, 16, 19, 20, 21, 22, 23, 24], "provid": [1, 3, 6, 7, 8, 9, 12, 13, 23], "182": [1, 3, 6, 7, 8, 9, 13], "instead": [1, 3, 6, 7, 8, 9, 12, 13, 19, 20, 23, 24], "anatom": [1, 3, 6, 7, 8, 9, 12, 13, 19, 20], "kernel": [1, 2, 3, 6, 8, 9, 12, 13, 19, 20, 21, 23], "209": [1, 3, 6, 7, 8, 9, 12, 13], "bcd": [1, 3, 6, 7, 8, 9, 11, 12, 14, 15, 19, 20, 21, 22, 23], "step": [1, 3, 6, 7, 8, 9, 12, 13, 19, 20, 21, 22], "10": [1, 2, 3, 4, 6, 7, 8, 9, 12, 16, 21, 22, 23], "738227903842926": 1, "512": [1, 3, 6, 7, 8, 9, 12, 13], "030361253768205643": 1, "22": [1, 13, 23], "3": [1, 2, 3, 4, 6, 7, 8, 9, 12, 13, 18, 23], "04648213088512421": 1, "04231761768460274": 1, "23": [1, 6, 7, 10], "09883110225200653": 1, "6": [1, 3, 6, 12, 13, 23], "10006309300661087": 1, "24": [1, 6, 10], "7": [1, 3, 6, 7, 8, 9, 10, 12, 13, 18, 23], "028383420780301094": 1, "025984298437833786": 1, "25": 1, "9": [1, 2, 3, 8, 9, 12, 13], "02610396035015583": 1, "026043901219964027": 1, "The": [1, 2, 3, 6, 7, 17, 23], "access": [1, 3, 7, 13], "after": [1, 3], "model": [1, 3, 6, 7, 24], "ha": [1, 6, 7], "been": [1, 3], "pi": [1, 3, 6, 7, 8, 9, 13, 19, 20, 21, 22], "print": [1, 3, 6, 7, 8, 9, 13], "f": [1, 3, 6, 7, 8, 9, 13, 21, 22], "total": [1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 19, 20, 21, 22], "mass": [1, 3, 19, 20, 23], "sum": [1, 3, 7, 19, 20], "5f": [1, 3], "99999": 1, "here": [1, 2, 3, 6, 7], "evolut": [1, 3, 6, 7, 12], "dure": [1, 3, 6, 7, 21, 22], "well": [1, 2, 3, 6, 7, 13, 23], "contribut": [1, 3, 7, 16], "each": [1, 2, 3, 6, 7, 8, 9, 11, 12, 14, 15, 19, 20, 21, 22, 23, 24], "term": [1, 3, 6, 7, 19, 20, 21, 22], "subplot": [1, 3, 6, 7, 12], "set_ylabel": [1, 3, 6, 7, 12, 13], "set_xlabel": [1, 3, 6, 7, 12, 13], "stackplot": [1, 3, 6, 7], "loss_step": [1, 3, 6, 7, 12, 19, 20, 21, 22], "arrai": [1, 3, 8, 9, 19, 20, 21, 22], "gromov_wasserstein": [1, 3, 6, 7, 19, 20, 21, 22], "marginal_constraint_dim1": [1, 3, 6, 7, 19, 20, 21, 22], "marginal_constraint_dim2": [1, 3, 6, 7, 19, 20, 21, 22], "regular": [1, 3, 6, 7, 19, 20, 21, 22], "store": [1, 3, 6, 7, 21, 22, 24], "tensor": [1, 3, 6, 13, 21, 22], "small": [1, 6], "enough": [1, 6, 7], "displai": [1, 6, 7], "altogeth": [1, 6], "vertic": [1, 2, 3, 6, 7, 9, 20, 23], "im": [1, 2, 6, 7, 8], "imshow": [1, 2, 6, 7, 8], "cmap": [1, 6, 7, 8, 9, 12], "viridi": [1, 6, 7, 8], "colorbar": [1, 2, 6, 7, 8, 9], "shrink": [1, 2, 6, 7], "previou": [1, 23], "tell": 1, "veri": [1, 3, 6, 7, 23], "anoth": [1, 23], "inform": [1, 6, 7, 13, 23], "wai": [1, 7], "look": [1, 2, 3, 6, 7, 23], "consist": [1, 17], "check": [1, 2, 6, 7, 13], "which": [1, 2, 3, 5, 6, 7, 13, 15, 17, 18, 19, 20, 21, 22, 23, 24], "were": [1, 6, 7, 23], "match": [1, 3, 6, 7, 8, 9, 13, 23], "togeth": 1, "space": [1, 3, 19, 20], "ndisplai": [1, 3], "draw": [1, 3], "line": [1, 3, 6, 7, 12], "indic": [1, 3, 6, 7, 9], "cartesian_prod": [1, 3], "arang": [1, 3], "segment": [1, 3, 12], "stack": [1, 3, 6, 7], "permut": [1, 3], "pi_norm": [1, 3], "line_seg": [1, 3], "flatten": [1, 3], "color": [1, 3, 6, 7, 8, 9, 12], "black": [1, 3, 8, 9, 12], "lw": [1, 3], "zorder": [1, 3], "add_collect": [1, 3], "unseen": [1, 3, 6, 7], "source_features_test": [1, 3], "rand": [1, 3], "target_features_test": [1, 3], "transformed_data": [1, 3], "transform": [1, 3, 6, 7, 8, 9, 17, 19, 20, 24], "assert": [1, 2, 3], "run": [1, 2, 3, 6, 7, 8, 9, 12, 13, 16, 18, 19, 20, 21, 22, 23], "time": [1, 2, 3, 6, 7, 8, 9, 12, 13, 19, 20, 21, 22, 24], "script": [1, 2, 3, 6, 7, 8, 9, 12, 13], "minut": [1, 2, 3, 6, 7, 8, 9, 12, 13], "432": [1, 4], "second": [1, 2, 3, 6, 7, 8, 9, 12, 13, 23], "estim": [1, 2, 3, 6, 8, 9, 12, 13], "44": [1, 3, 4, 8, 9], "mb": [1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14], "python": [1, 2, 3, 6, 7, 8, 9, 12, 13, 18], "plot_1_dens": [1, 4], "jupyt": [1, 2, 3, 6, 7, 8, 9, 12, 13], "notebook": [1, 2, 3, 6, 7, 8, 9, 12, 13], "ipynb": [1, 2, 3, 6, 7, 8, 9, 12, 13], "galleri": [1, 2, 3, 6, 7, 8, 9, 12, 13, 15], "sphinx": [1, 2, 3, 6, 7, 8, 9, 12, 13, 15], "deriv": [2, 7, 23], "matrix": [2, 6, 7, 8, 9, 12, 19, 20, 21, 22, 23], "geodes": [2, 6, 7], "distanc": [2, 6, 7, 8, 9, 12, 19, 20, 23], "given": [2, 7, 13, 19, 20], "techniqu": 2, "try": [2, 3, 7, 23], "number": [2, 3, 6, 7, 9, 19, 20, 21, 22, 23], "inde": [2, 6, 7], "pairwis": 2, "won": [2, 7, 16], "t": [2, 3, 7, 8, 9, 12, 13, 16, 23], "right": [2, 6, 7, 8, 9, 12, 13], "dimens": [2, 7], "probabl": [2, 6, 7, 8, 9], "gdist": [2, 6], "lmd": [2, 7, 9], "nilearn": [2, 6, 7, 8, 9, 12], "dataset": [2, 6, 7, 8, 9, 12], "surfac": [2, 5, 10, 12, 15], "exact": [2, 23], "vertex": [2, 6, 7], "n_landmark": [2, 7], "k": [2, 7, 20, 22, 23], "100": [2, 3, 7, 8, 9, 13], "load": [2, 6, 7, 17, 24, 26], "pre": [2, 8, 9, 16], "first": [2, 6, 7, 8, 9, 12, 19, 20, 23], "fsaverage3": [2, 6], "fetch_surf_fsaverag": [2, 6, 7], "coordin": [2, 6, 7, 8, 9, 12, 13, 19, 20, 21, 22, 23], "triangl": [2, 6, 7], "load_surf_mesh": [2, 6, 7], "sphere_left": 2, "creat": [2, 6, 7], "github": [2, 3, 6, 16], "home": [2, 6], "nilearn_data": [2, 6], "http": [2, 3, 6, 12, 16, 23], "osf": [2, 6, 12], "io": [2, 6, 12], "azhdf": 2, "done": [2, 6, 12], "min": [2, 6, 12], "extract": [2, 8], "472ead7320dbd53fb2ec42e05f1bb6bf": 2, "642": [2, 6], "plot_trisurf": 2, "easi": [2, 7], "parallel": [2, 7], "x": [2, 7, 9, 13, 20, 21, 22], "compute_lmds_mesh": [2, 7], "n_job": [2, 7], "landmark": [2, 7, 23], "00": [2, 3, 4, 7, 9, 12, 14], "02": [2, 7, 8, 10, 14], "workspac": [2, 3], "src": [2, 3], "175": 2, "A": [2, 23], "might": [2, 6, 7, 12], "center": [2, 6, 7], "8740234375": 2, "001": 2, "It": [2, 7, 19, 20, 21, 22, 24], "correct": 2, "actual": [2, 6, 7, 8, 9], "peek": 2, "pair": [2, 3, 7, 9, 21, 22], "211": 2, "true_kernel_matrix": 2, "local_gdist_matrix": [2, 6], "astyp": [2, 6], "float64": [2, 6], "int32": [2, 6], "toarrai": [2, 6], "212": 2, "approximated_kernel_matrix": 2, "cdist": 2, "715": [2, 4], "150": [2, 4], "plot_2_1_lmd": [2, 4], "more": [3, 6, 7], "map": [3, 8, 9, 12, 13, 17, 25, 26], "fugwspars": [3, 7, 9, 24], "coarse_to_fin": [3, 7, 9], "scipi": [3, 7, 8, 12], "coo_matrix": [3, 7], "13": 3, "300": [3, 9], "n_samples_sourc": 3, "n_samples_target": 3, "do": [3, 18], "forget": [3, 9], "source_embeddings_norm": [3, 7, 9], "source_d_max": 3, "random_norm": [3, 7, 9], "target_embeddings_norm": [3, 7, 9], "target_d_max": 3, "coars": [3, 7, 9], "fine": [3, 7, 9], "grain": [3, 6, 7, 9], "also": [3, 6, 7, 16, 17, 23], "specifi": 3, "alpha_coars": [3, 7, 9], "rho_coars": [3, 7, 9], "eps_coars": [3, 7, 9], "coarse_map": [3, 7, 9], "coarse_mapping_solv": [3, 7, 9], "mm": [3, 6, 7, 8, 9, 19, 20, 21, 22, 23], "coarse_mapping_solver_param": [3, 7, 9], "tol_uot": [3, 6, 7, 9, 21, 22], "alpha_fin": [3, 7, 9], "rho_fin": [3, 7, 9], "eps_fin": [3, 7, 9], "fine_map": [3, 7, 9], "fine_mapping_solv": [3, 7, 9], "fine_mapping_solver_param": [3, 7, 9], "limit": [3, 6, 7], "randomli": [3, 7], "you": [3, 6, 7, 12, 16, 18, 19, 20, 24], "carefulli": 3, "set": [3, 6, 7, 8, 9, 11, 14, 15, 19, 20, 21], "selection_radiu": 3, "thei": [3, 6, 7, 12, 17, 23], "greatli": [3, 8], "affect": [3, 7], "sparsiti": [3, 7, 9, 20], "usual": [3, 6, 7, 12], "domain": [3, 17], "knowledg": 3, "relat": [3, 11, 15], "sub": [3, 6, 7], "source_sampl": [3, 7, 9], "randperm": 3, "target_sampl": [3, 7, 9], "source_featur": [3, 6, 7, 8, 9, 12, 19, 20], "target_featur": [3, 6, 7, 8, 9, 12, 19, 20], "source_geometry_embed": [3, 7, 9, 20], "target_geometry_embed": [3, 7, 9, 20], "parametr": [3, 7, 9], "select": [3, 7, 9], "present": [3, 7, 9, 12, 23], "mask": [3, 6, 7, 9, 12, 20], "coarse_pairs_selection_method": [3, 7, 9], "topk": [3, 7, 9], "source_selection_radiu": [3, 7, 9], "target_selection_radiu": [3, 7, 9], "misc": [3, 7, 9], "38": [3, 6, 9], "03933345898985863": 3, "39": [3, 6, 7], "03429536148905754": 3, "025622759014368057": 3, "023492945358157158": 3, "02284521982073784": 3, "022538797929883003": 3, "41": [3, 6, 7], "022327778860926628": 3, "42": [3, 7, 8], "02214662730693817": 3, "43": [3, 6, 8, 12], "022022832185029984": 3, "02194823883473873": 3, "463": 3, "csr": [3, 20], "support": 3, "beta": 3, "state": 3, "If": [3, 16, 19, 20, 24, 26], "miss": 3, "function": [3, 6, 7, 11, 13, 15, 17, 19, 20, 21, 22, 23], "pleas": [3, 6, 16], "submit": 3, "request": 3, "com": [3, 16, 23], "pytorch": [3, 16], "issu": [3, 7, 23], "trigger": 3, "intern": [3, 16], "aten": 3, "sparsecsrtensorimpl": 3, "cpp": 3, "54": [3, 6, 12], "203": [3, 6, 7, 9], "247": [3, 7, 9], "47": [3, 6, 9, 12, 14], "027974741533398628": 3, "574": [3, 7, 9], "51": [3, 13], "021580731496214867": 3, "01972450315952301": 3, "57": [3, 6, 7], "01904219575226307": 3, "35": [3, 9], "01": [3, 4, 7, 10, 14, 19, 20, 21, 22], "018711335957050323": 3, "05": [3, 6], "018519390374422073": 3, "09": [3, 7, 8], "018395699560642242": 3, "14": 3, "01831030286848545": 3, "018248513340950012": 3, "28": [3, 8], "01820109784603119": 3, "99638": 3, "99723": 3, "similar": [3, 6, 7, 23], "plot": [3, 6, 7, 8, 9, 12, 13], "about": [3, 6, 7, 23], "60": [3, 6], "what": [3, 6, 7], "equival": [3, 7, 23], "would": [3, 6, 7], "high": [3, 5, 6, 10, 13, 15, 19, 20], "want": [3, 6, 7, 24], "keep": [3, 6, 7], "smaller": 3, "sparsity_ratio": 3, "valu": [3, 6, 7, 12, 13, 19, 20, 21, 22, 23], "numel": [3, 7, 13], "ratio": 3, "non": [3, 6, 7, 23], "null": [3, 7], "coeffici": [3, 7], "2f": [3, 6, 7, 8, 9], "87": 3, "particular": [3, 13], "don": [3, 9], "expect": [3, 7], "particularli": 3, "meaning": 3, "structur": [3, 7, 23], "fine_mapping_as_scipy_coo": [3, 7], "spy": [3, 7], "precis": [3, 7], "markers": [3, 7], "observ": 3, "to_dens": [3, 7], "nan_to_num": [3, 6, 7, 8, 9, 12], "58": [3, 4, 9, 10], "050": [3, 4], "147": [3, 4], "plot_2_2_coarse_to_fin": [3, 4], "198": 4, "execut": [4, 10, 14], "auto_examples_00_bas": 4, "file": [4, 10, 14, 24, 26], "06": [4, 6, 9, 21, 22], "subsect": [5, 15], "give": [5, 15], "exhaust": [5, 15], "overview": [5, 15], "pipelin": [5, 15], "case": [5, 6, 7, 11, 12, 15, 19, 20, 23], "volumetr": [5, 6, 7, 15], "resolut": [5, 10, 12, 15], "individu": [5, 10, 15, 16, 19, 20, 23], "fmri": [5, 10, 12, 15, 19, 20], "volum": [5, 10, 12, 15], "left": [6, 7, 8, 9, 12], "hemispher": [6, 7], "z": [6, 7, 8, 9], "score": [6, 7, 8, 9], "contrast": [6, 7, 8, 9, 12, 19, 20], "mpl": [6, 7], "gridspec": [6, 7], "load_map": [6, 26], "save_map": [6, 26], "mpl_toolkit": [6, 7, 8, 9], "axes_grid1": [6, 7, 8, 9], "make_axes_locat": [6, 7, 8, 9], "imag": [6, 7, 8, 9, 12], "per": [6, 7], "api": [6, 7, 16], "subject": [6, 7, 8, 9, 12, 19, 20], "out": [6, 7], "assess": [6, 7], "qualiti": [6, 7], "our": [6, 7, 13, 19, 20], "n_subject": [6, 7, 8, 9, 12], "sentenc": [6, 7, 8, 9, 12], "read": [6, 7, 8, 9, 12], "v": [6, 7, 8, 9, 12], "checkerboard": [6, 7, 8, 9, 12], "listen": [6, 7, 8, 9, 12], "calcul": [6, 7, 8, 9, 12], "button": [6, 7, 8, 9, 12], "press": [6, 7, 8, 9, 12, 23], "n_training_contrast": [6, 7, 8, 9, 12], "brain_data": [6, 7, 8, 9, 12], "fetch_localizer_contrast": [6, 7, 8, 9, 12], "get_anat": [6, 7, 8, 9, 12], "source_imgs_path": [6, 7, 8, 9, 12], "len": [6, 7, 8, 9, 12, 13], "target_imgs_path": [6, 7, 8, 9, 12], "brainomics_loc": 6, "hwbm2": 6, "5d27cd441c5b4a001aa08008": 6, "5d27c03e45253a001c3e189f": 6, "5d27bfd0114a420016057cba": 6, "5d27cb281c5b4a001aa07e29": 6, "5d27cc0845253a001c3e22bd": 6, "5d27d10b114a420019044ed8": 6, "5d27d89d1c5b4a001d9f5e6": 6, "5d27d429a26b340017083380": 6, "5d27ddc91c5b4a001b9ef9d0": 6, "5d27d14f114a420019044efc": 6, "5d275eb845253a001c3dbf76": 6, "8478720": 6, "14012301": 6, "byte": 6, "remain": 6, "5d275ede1c5b4a001aa00c26": 6, "13951266": 6, "5d27037f45253a001c3d4563": 6, "5d7b8948fcbf44001c44e695": 6, "func": [6, 7, 8, 9, 12], "893": [6, 7, 8, 9, 12], "legacy_format": [6, 7, 8, 9, 12], "default": [6, 7, 8, 9, 12, 19, 20, 21, 22, 26], "fals": [6, 7, 8, 9, 12, 19, 20, 21, 22], "releas": [6, 7, 8, 9, 12], "11": [6, 7, 8, 9, 10, 12, 18], "fetcher": [6, 7, 8, 9, 12], "return": [6, 7, 8, 9, 12, 13, 19, 20, 21, 22, 26], "panda": [6, 7, 8, 9, 12], "datafram": [6, 7, 8, 9, 12], "recarrai": [6, 7, 8, 9, 12], "like": [6, 19, 20, 24], "follow": [6, 7, 19, 20, 21, 22], "interact": [6, 7], "contrast_index": [6, 7, 8, 9], "view_img": 6, "anat": 6, "titl": [6, 12, 16], "opac": 6, "_util": 6, "niimg": 6, "62": 6, "finit": 6, "These": [6, 17], "replac": 6, "zero": [6, 7, 9], "core": 6, "fromnumer": 6, "784": 6, "warn": 6, "partit": 6, "ignor": 6, "maskedarrai": 6, "repres": [6, 23], "cortic": [6, 7, 19, 20, 23], "aggreg": [6, 7], "build": [6, 7], "For": [6, 7, 17, 23], "sake": [6, 7], "phase": [6, 7], "short": [6, 7, 13, 23], "even": [6, 7], "cpu": [6, 7, 8, 9, 13, 16, 19, 20], "made": [6, 7], "def": [6, 7, 13], "load_images_and_project_to_surfac": [6, 7], "image_path": [6, 7], "load_img": [6, 7, 8, 9, 12], "img": [6, 7], "surface_imag": [6, 7], "vol_to_surf": [6, 7], "pial_left": [6, 7], "460": [6, 7], "runtimewarn": [6, 7, 12], "mean": [6, 7, 24], "empti": [6, 7], "slice": [6, 7], "plot_surface_map": [6, 7], "surface_map": [6, 7], "coolwarm": [6, 7, 8, 9], "kwarg": [6, 7], "plot_surf": [6, 7], "bg_map": [6, 7], "sulc_left": [6, 7], "bg_on_data": [6, 7], "dark": [6, 7], "grid_spec": [6, 7], "all": [6, 7, 8, 13, 18, 19, 20, 21, 22, 23], "contrast_nam": [6, 7], "enumer": [6, 7], "j": [6, 7, 20, 23], "vmax": [6, 7], "vmin": [6, 7], "add": [6, 7, 8], "rang": [6, 7, 13, 18], "axi": [6, 7, 8, 9, 12], "off": [6, 7], "text": [6, 7, 8, 9, 23], "va": [6, 7], "divid": [6, 7, 8, 9], "cax": [6, 7, 8, 9], "append_ax": [6, 7, 8, 9], "add_ax": [6, 7], "cm": [6, 7], "scalarmapp": [6, 7], "note": [6, 7, 23], "same": [6, 7, 9, 19, 20, 21, 22, 24], "doe": [6, 7], "compute_geometry_from_mesh": 6, "mesh_path": 6, "fsaverage3_pial_left_geometri": 6, "vertex_index": [6, 7, 8, 9], "matric": [6, 23], "contain": [6, 7, 11, 15, 17, 19, 20, 21, 22], "millimet": [6, 7], "other": [6, 7, 17], "111": [6, 7, 8], "magma": [6, 7], "cbar_tick_format": [6, 7], "without": 6, "scale": [6, 7, 23], "unclear": 6, "whether": [6, 7], "compar": [6, 7, 8, 9], "moreov": [6, 7, 23], "hyper": [6, 7, 24], "paramet": [6, 7, 19, 20, 21, 22, 24, 26], "depend": [6, 16], "respect": [6, 7, 13, 23], "empir": [6, 7, 18], "lead": [6, 7, 12], "nan": [6, 12], "source_features_norm": [6, 7, 8, 9, 12], "target_features_norm": [6, 7, 8, 9, 12], "interest": [6, 13], "preserv": [6, 23], "leav": [6, 23], "too": [6, 7, 13, 23], "faster": [6, 7, 24], "blurri": 6, "solwer": 6, "finer": 6, "meant": 6, "gpu": [6, 7, 16, 19, 20], "100x": 6, "slower": [6, 12], "rememb": [6, 7], "onli": [6, 7, 23, 24], "block": [6, 13, 19, 20, 21, 22, 23], "descent": [6, 13, 19, 20, 21, 22, 23], "iter": [6, 7, 8, 9, 11, 12, 14, 15, 21, 22], "order": [6, 7, 8, 9, 12, 16, 24], "solver_param": [6, 8, 12, 13, 19, 20], "nits_bcd": [6, 7, 8, 9, 12, 13, 21, 22], "36": 6, "16": [6, 9, 12], "031836479902267456": 6, "37": [6, 12, 13], "00878827553242445": 6, "008764689788222313": 6, "n": [6, 7, 8, 9, 13, 19, 20, 21, 22, 23], "loss_tim": [6, 19, 20, 21, 22], "1f": [6, 7], "becaus": [6, 7], "known": 6, "commun": 6, "librari": 6, "come": [6, 7, 17, 24], "most": [6, 24], "retrain": 6, "implement": [6, 16, 23, 25], "maxim": 6, "minim": [6, 23], "approach": [6, 23], "solut": [6, 7, 17, 21, 22, 23], "mm_map": 6, "tol_bcd": [6, 21, 22], "03922216221690178": 6, "0161117035895586": 6, "010619010776281357": 6, "009688025340437889": 6, "009318884462118149": 6, "ibpp": [6, 19, 20, 21, 22, 23], "ibpp_map": 6, "036076657474040985": 6, "010708280839025974": 6, "00930926576256752": 6, "009012906812131405": 6, "008895785547792912": 6, "easili": [6, 7, 9, 17, 24], "save": [6, 17, 24, 26], "disk": 6, "back": 6, "overwrit": [6, 24], "pickl": [6, 24, 26], "so": [6, 7, 8, 9], "weight": [6, 19, 20, 24, 26], "separ": [6, 24, 26], "handi": [6, 17], "quickli": 6, "pkl": 6, "mapping_without_weight": 6, "load_weight": [6, 26], "With": 6, "custom": 6, "dump": 6, "hyperparam": [6, 21, 22, 26], "84": 6, "document": 6, "93": 6, "none": [6, 19, 20, 21, 22], "though": [6, 7], "need": [6, 7], "converg": [6, 7, 11, 14, 15], "reach": 6, "tweak": 6, "nits_uot": [6, 13, 21, 22], "get": 6, "fastest": 6, "rate": 6, "suptitl": [6, 7, 8, 9, 13], "comparison": 6, "nsinkhorn": 6, "121": [6, 13], "122": 6, "tight_layout": [6, 8, 9, 12], "fontsiz": [6, 7], "20": [6, 7, 9, 12], "interpret": [6, 7], "describ": [6, 7, 23], "probability_map": [6, 7, 8, 9], "being": [6, 7, 8, 9], "ani": [6, 7], "anatomi": [6, 7, 23], "onto": [6, 7], "convers": [6, 7], "inverse_transform": [6, 7, 9, 19, 20, 24], "take": [6, 7], "predicted_target_featur": [6, 7, 8, 9], "predict": [6, 7, 8, 9], "part": [6, 7, 23], "trane": [6, 7], "realli": [6, 7], "help": [6, 7], "evalu": [6, 7, 19, 20, 21, 22], "captur": [6, 7], "test": [6, 7, 8, 9, 12, 16, 18], "931": [6, 10], "plot_1_aligning_brain_dens": [6, 10], "sinc": 7, "stick": 7, "rather": 7, "around": 7, "abov": 7, "150k": 7, "appropri": 7, "v100": 7, "nvidia": 7, "tutori": 7, "through": [7, 23], "brain": [7, 8, 9, 12, 16, 23], "explain": 7, "rope": 7, "detail": [7, 23], "current": [7, 13], "focu": 7, "real": [7, 12], "life": 7, "copi": [7, 8, 12], "surf_plot": 7, "camera": 7, "layout": [7, 13], "plotli": 7, "make_subplot": 7, "seed": 7, "10242": 7, "fsaverage5": [7, 12], "engin": 7, "els": [7, 13], "assum": 7, "m": [7, 13, 19, 20, 21, 22, 23], "power": 7, "rule": 7, "thumb": 7, "greater": 7, "50k": 7, "therefor": 7, "cannot": 7, "explicitli": 7, "under": [7, 16, 19, 20, 21, 22, 25], "hood": [7, 25], "higher": 7, "although": 7, "speed": 7, "rest": 7, "procedur": [7, 21, 22, 23], "invest": 7, "fs5_pial_left_geometry_embed": 7, "12": [7, 8, 9], "tricki": 7, "method": [7, 17, 19, 20, 21, 22, 23, 24], "perform": 7, "oper": 7, "vector": 7, "l2": [7, 21, 22], "eventu": [7, 8], "maximum": 7, "found": [7, 23], "process": [7, 19, 20, 21, 22, 23], "source_distance_max": [7, 9], "target_distance_max": [7, 9], "one": [7, 17, 23], "leverag": 7, "gather": 7, "differ": [7, 19, 20, 21, 22], "could": 7, "poor": 7, "some": [7, 11, 15, 17, 19, 20], "area": [7, 23], "bad": [7, 12], "consequ": [7, 23], "uniformli": 7, "spread": 7, "across": 7, "ward": 7, "algorithm": [7, 13, 23], "sample_mesh_uniformli": 7, "n_sampl": [7, 9, 19, 20], "inspect": 7, "switch": 7, "source_sampled_surfac": 7, "target_sampled_surfac": 7, "row": 7, "col": 7, "spec": 7, "type": [7, 13], "subplot_titl": 7, "fig_sourc": 7, "blue": [7, 12], "fig_target": 7, "add_trac": 7, "edit": 7, "deepcopi": 7, "margin": [7, 19, 20, 21, 22], "l": [7, 21, 22, 23], "r": [7, 13], "b": 7, "pad": [7, 8], "scene": 7, "ey": 7, "y": [7, 12], "scene2": 7, "update_layout": 7, "height": 7, "400": 7, "width": 7, "800": 7, "title_text": 7, "title_x": 7, "rational": 7, "within": [7, 21, 22], "certain": 7, "radiu": [7, 9], "appear": 7, "word": 7, "far": 7, "see": [7, 13, 19, 20], "proport": 7, "allow": [7, 13, 19, 20, 23, 24], "properti": 7, "scalabl": 7, "n_neighbourhoods_per_vertex_sourc": 7, "get_neighbourhood_matrix": 7, "n_neighbourhoods_per_vertex_target": 7, "deep": 7, "light": 7, "white": 7, "close": 7, "absent": 7, "effect": 7, "source_vertices_in_mask": 7, "target_vertices_in_mask": 7, "just": 7, "saw": 7, "7mm": 7, "entier": 7, "One": 7, "increas": 7, "circumv": [7, 23], "cost": [7, 8, 12, 21, 22], "advis": 7, "practic": [7, 12], "10mm": 7, "wa": [7, 16, 19, 20, 21, 22], "t0": 7, "t1": 7, "32": [7, 8], "025860445573925972": 7, "01786630228161812": 7, "52": [7, 13], "008813753724098206": 7, "004003822337836027": 7, "003033315995708108": 7, "02159947156906128": 7, "01816076599061489": 7, "46": [7, 8, 9], "018097281455993652": 7, "few": 7, "good": [7, 23], "strategi": 7, "alreadi": 7, "big": 7, "still": 7, "top": 7, "corder": 7, "alwai": 7, "due": 7, "fact": 7, "uniform": 7, "compabl": 7, "coarse_pi": 7, "corner": 7, "200": 7, "howev": [7, 24], "exhibit": 7, "correspond": 7, "yield": 7, "reason": 7, "diagon": 7, "quit": 7, "1553141947681953": 7, "ith": 7, "fetch": [7, 8, 9, 12], "hot": 7, "vertor": 7, "whose": [7, 20], "posit": 7, "one_hot": [7, 9], "55": [7, 10], "708": [7, 10], "660": 7, "plot_2_aligning_brain_spars": [7, 10], "spatial": [8, 12], "distance_matrix": [8, 12], "source_im": [8, 9, 12], "target_im": [8, 9, 12], "downsampl": [8, 12], "reduc": [8, 12], "scale_factor": [8, 9, 12], "source_map": [8, 9, 12], "get_fdata": [8, 9, 12], "target_map": [8, 9, 12], "segmentation_fin": [8, 9], "logical_not": [8, 9], "isnan": [8, 9], "segmentation_coars": [8, 9], "nonzero": [8, 9], "voxel": [8, 9, 12, 23], "marker": [8, 9, 12], "o": [8, 9, 12], "view_init": [8, 9, 12], "135": [8, 9, 12], "set_axis_off": [8, 9], "up": [8, 16], "roughli": 8, "500": [8, 13], "484": 8, "c": [8, 9], "set_posit": [8, 9], "03": [8, 9, 10], "avoid": [8, 9, 12], "numer": [8, 9, 12], "error": [8, 9, 12, 18, 19, 20], "59": [8, 9], "02850188873708248": 8, "29": [8, 9], "014847730286419392": 8, "013132133521139622": 8, "012767803855240345": 8, "4th": 8, "sqrt": 8, "75": [8, 9], "pearson": [8, 9], "correl": [8, 9], "corr_pre_map": [8, 9], "corrcoef": [8, 9], "corr_post_map": [8, 9], "post": [8, 9], "rel": [8, 9, 19, 20], "improv": [8, 9], "19": [8, 13, 23], "centerednorm": [8, 9], "251": [8, 10], "plot_3_aligning_low_res_volum": [8, 10], "2000": 9, "singl": 9, "2258": 9, "compute_lmds_volum": 9, "clone": [9, 16], "subsampl": 9, "sample_volume_uniformli": 9, "sklearn": 9, "cluster": 9, "_agglom": 9, "282": 9, "connect": 9, "compon": [9, 19, 20, 21, 22], "complet": 9, "stop": [9, 21, 22], "tree": 9, "earli": [9, 21, 22], "3mm": 9, "radia": 9, "unit": [9, 13], "025019675493240356": 9, "26": [9, 23], "020169807597994804": 9, "011266662739217281": 9, "45": 9, "006853275001049042": 9, "005719500593841076": 9, "009396675042808056": 9, "006626536138355732": 9, "005600947421044111": 9, "300th": 9, "red": [9, 12], "49": [9, 12, 13, 14], "027": [9, 10], "plot_4_aligning_high_res_volum": [9, 10], "918": 10, "auto_examples_01_brain_align": 10, "659": 10, "202": 10, "07": [10, 12, 21, 22], "seri": [11, 15, 23], "tool": [11, 15], "directli": [11, 15], "main": [11, 15, 17, 24], "monitor": [11, 14, 15], "callback": [11, 14, 15, 19, 20, 21, 22], "independ": [12, 19, 20], "examin": 12, "get_mask": 12, "source_mask": 12, "5d27cdcaa26b340018084b30": 12, "5d27d80c114a420016058f7d": 12, "resized_source_affin": 12, "affin": 12, "resized_target_affin": 12, "source_im_res": 12, "resample_img": 12, "target_im_res": 12, "mask_res": 12, "argwher": 12, "make": [12, 16, 17, 18, 21, 22], "pane": 12, "transpar": 12, "xaxi": 12, "set_pane_color": 12, "yaxi": 12, "zaxi": 12, "grid": 12, "_axinfo": 12, "resampl": 12, "673": 12, "infinit": 12, "pass": 12, "thing": 12, "ill": 12, "294": 12, "binari": 12, "continu": 12, "linear": [12, 23], "interpol": [12, 19, 20], "unexpect": 12, "consid": [12, 21, 22], "nearest": 12, "last": 12, "kept": 12, "ident": 12, "source_features_v": [12, 19, 20], "target_features_v": [12, 19, 20], "026567133143544197": 12, "030553318560123444": 12, "012580106034874916": 12, "01490634772926569": 12, "010229995474219322": 12, "011879166588187218": 12, "48": 12, "009844273328781128": 12, "011247752234339714": 12, "27": 12, "009588906541466713": 12, "010830595158040524": 12, "009423702955245972": 12, "010599461384117603": 12, "009309254586696625": 12, "010493515990674496": 12, "00920140091329813": 12, "010404586791992188": 12, "33": 12, "009098006412386894": 12, "010212155058979988": 12, "009051804430782795": 12, "010106334462761879": 12, "ax1": 12, "tick_param": 12, "labelcolor": 12, "loss_val": [12, 19, 20, 21], "otherwis": [12, 19, 20], "slightli": 12, "clip": 12, "example_arrai": 12, "slicer": 12, "ab": [12, 16, 23], "new_img_lik": 12, "view_img_on_surf": 12, "threshold": [12, 21, 22], "surf_mesh": 12, "844": [12, 14], "plot_1_simple_crossv": [12, 14], "leak": 13, "devic": [13, 19, 20], "re": [13, 21, 22], "functool": 13, "partial": 13, "rich": 13, "consol": 13, "tabl": 13, "relev": 13, "receiv": 13, "dictionari": [13, 19, 20, 21, 22], "variabl": [13, 19, 20, 21, 22], "scope": 13, "filter": 13, "is_spars": 13, "str": [13, 21, 22, 26], "find": 13, "str_size": 13, "group": 13, "str_mem": 13, "mem": 13, "kb": 13, "1024": 13, "3f": 13, "elif": 13, "check_memory_usag": 13, "name": [13, 23], "item": 13, "is_tensor": 13, "append": 13, "sort": 13, "kei": [13, 19, 20, 21, 22], "lambda": 13, "lower": [13, 23], "add_column": 13, "justifi": 13, "alloc": 13, "memory_alloc": 13, "_nnz": 13, "var_memory_alloc": 13, "element_s": 13, "add_row": 13, "add_sect": 13, "style": 13, "bold": 13, "memory_at_bcd_step": 13, "cuda": 13, "memory_lin": 13, "cach": 13, "memory_cach": 13, "reserv": 13, "memory_reserv": 13, "log": [13, 19, 20, 21, 22], "list": [13, 19, 20, 21, 22], "join": 13, "callback_bcd": [13, 19, 20, 21, 22], "338768005371094": 13, "cost_gamma": 13, "000": 13, "812": 13, "cost_pi": 13, "d": [13, 21, 22, 23], "766": 13, "ds_sqr": 13, "ds_sqr_val": 13, "ds_val": [13, 21, 22], "dt": [13, 21, 22], "600": 13, "250": 13, "dt_sqr": 13, "dt_sqr_val": 13, "dt_val": [13, 21, 22], "gamma": [13, 21, 22], "l1_gamma": 13, "004": 13, "l1_pi": 13, "new_ep": 13, "new_rho_": 13, "new_rho_t": 13, "pi_prev": 13, "w": [13, 19, 20, 21, 22, 23], "195": 13, "ws_dot_wt": 13, "wt": [13, 21, 22], "156": 13, "119": 13, "31": 13, "526891708374023": 13, "415464401245117": 13, "9791483879089355": 13, "8778457641601562": 13, "constant": 13, "set_xtick": 13, "643": [13, 14], "plot_2_memory_usage_callback": [13, 14], "487": 14, "auto_examples_02_miscellan": 14, "multipl": [16, 23], "compat": 16, "activ": [16, 23], "develop": 16, "There": 16, "guarante": 16, "chang": 16, "futur": 16, "To": [16, 23], "sure": 16, "date": 16, "version": [16, 18], "pip": [16, 18], "dedic": 16, "env": 16, "git": 16, "alexisthu": 16, "cd": [16, 18], "e": [16, 18], "contributor": 16, "automat": 16, "format": 16, "dev": [16, 18], "commit": 16, "configur": 16, "your": [16, 24], "machin": 16, "pytest": 16, "articl": 16, "thual": [16, 23], "2022": [16, 23], "author": [16, 23], "alexi": [16, 23], "tran": [16, 23], "hui": [16, 23], "zemskova": [16, 23], "tatiana": [16, 23], "courti": [16, 23], "nicola": [16, 23], "flamari": [16, 23], "r\u00e9mi": [16, 23], "dehaen": [16, 23], "stanisla": [16, 23], "thirion": [16, 23], "bertrand": [16, 23], "publish": 16, "arxiv": [16, 23], "doi": [16, 23], "48550": [16, 23], "2206": [16, 23], "09398": [16, 23], "url": 16, "org": [16, 23], "year": 16, "copyright": 16, "creativ": 16, "common": 16, "attribut": [16, 19, 20, 21, 22], "two": [17, 21, 22, 23], "modul": [17, 24], "former": 17, "class": [17, 19, 20, 21, 22, 23, 24, 25], "handl": 17, "signal": 17, "underli": [17, 23], "besid": 17, "instanc": [17, 23], "recommend": 18, "latest": 18, "while": [18, 23], "wide": 18, "know": 18, "rais": 18, "occur": 18, "instal": 18, "clean": 18, "html": [18, 23], "reg_mod": [19, 20, 21, 22], "joint": [19, 20, 21, 22], "__init__": [19, 20, 21, 22], "init": [19, 20, 21, 22], "float": [19, 20, 21, 22], "option": [19, 20, 21, 22, 26], "equat": [19, 20], "tupl": [19, 20, 21, 22], "inf": [19, 20], "control": [19, 20], "constraint": [19, 20, 21, 22, 23], "forc": [19, 20], "entropi": [19, 20], "gw": [19, 20, 23], "regularis": [19, 20], "ndarrai": [19, 20, 21, 22], "dict": [19, 20, 21, 22], "unweight": [19, 20, 21, 22], "elaps": [19, 20, 21, 22], "source_geometry_v": 19, "target_geometry_v": 19, "source_weight": [19, 20], "target_weight": [19, 20], "init_plan": [19, 20, 21, 22], "init_du": [19, 20, 21, 22], "auto": [19, 20], "studi": [19, 20], "n_featur": [19, 20], "node": [19, 20], "graph": [19, 20], "eahc": 19, "initialis": [19, 22], "dual": [19, 21, 22], "potenti": 19, "basesolv": [19, 20], "param": [19, 20], "callabl": [19, 20, 21, 22], "argument": [19, 20, 21, 22], "avail": [19, 20, 23], "bool": [19, 20, 21, 22, 26], "self": [19, 20], "object": [19, 20], "ot": [19, 20, 21, 22], "transported_data": [19, 20], "source_geometry_embedding_v": 20, "target_geometry_embedding_v": 20, "x_i": 20, "x_j": 20, "coo": 20, "early_stopping_threshold": [21, 22], "eval_bcd": [21, 22], "eval_uot": [21, 22], "ibpp_eps_bas": [21, 22], "ibpp_nits_sinkhorn": [21, 22], "int": [21, 22], "absolut": [21, 22], "consecut": [21, 22], "fall": [21, 22], "everi": [21, 22], "specif": [21, 22], "uot": [21, 22], "fugw_loss": [21, 22], "data_const": [21, 22], "tuple_weight": [21, 22], "scalar": [21, 22], "gromow": [21, 22], "kl": [21, 22], "entrop": [21, 22], "get_parameters_uot_l2": 21, "local_biconvex_cost": [21, 22], "transpos": [21, 22], "updat": [21, 22], "rho_": [21, 22], "rho_t": [21, 22], "f_val": [21, 22], "diverg": 21, "measur": [21, 22], "assign": [21, 22], "initi": 21, "coupl": [21, 22], "d1": [21, 22], "d2": [21, 22], "duals_pi": [21, 22], "duals_gamma": [21, 22], "p": 23, "denot": 23, "base": 23, "f_i": 23, "f_j": 23, "tri": 23, "below": 23, "essenc": 23, "distant": 23, "motiv": 23, "origin": 23, "neurip": 23, "paper": 23, "work": 23, "et": 23, "al": 23, "human": 23, "cortex": 23, "behav": 23, "throughout": 23, "experi": 23, "convex": 23, "understood": 23, "multitud": 23, "exist": 23, "appli": [23, 24], "cuturi": 23, "2013": 23, "prove": 23, "effici": 23, "unfortun": 23, "s\u00e9journ\u00e9": 23, "2021": 23, "bound": 23, "reformul": 23, "bi": 23, "sum_": 23, "s_": 23, "t_": 23, "p_": 23, "q": 23, "q_": 23, "impos": 23, "relax": 23, "altern": 23, "freez": 23, "resp": 23, "adapt": 23, "insid": 23, "classic": 23, "chizat": 23, "2017": 23, "major": 23, "chapel": 23, "inexact": 23, "bregman": 23, "proxim": 23, "xie": 23, "2020": 23, "june": 23, "marco": 23, "lightspe": 23, "advanc": 23, "neural": 23, "system": 23, "1306": 23, "0895": 23, "sejourn": 23, "thibault": 23, "francoi": 23, "xavier": 23, "vialard": 23, "gabriel": 23, "peyr\u00e9": 23, "conic": 23, "formul": 23, "8766": 23, "79": 23, "curran": 23, "associ": 23, "inc": 23, "proceed": 23, "cc": 23, "hash": 23, "4990974d150d0de5e6e15a1454fe6b0f": 23, "abstract": 23, "laetitia": 23, "haoran": 23, "wu": 23, "c\u00e9dric": 23, "f\u00e9vott": 23, "gill": 23, "gasso": 23, "neg": 23, "penal": 23, "regress": 23, "23270": 23, "82": 23, "c3c617a9b80b3ae1ebd868b0017cc349": 23, "yujia": 23, "xiangfeng": 23, "wang": 23, "ruijia": 23, "hongyuan": 23, "zha": 23, "fast": 23, "35th": 23, "uncertainti": 23, "artifici": 23, "intellig": 23, "confer": 23, "433": 23, "53": 23, "pmlr": 23, "mlr": 23, "v115": 23, "xie20b": 23, "platt": 23, "john": 23, "fastmap": 23, "metricmap": 23, "md": 23, "nystrom": 23, "januari": 23, "2005": 23, "www": 23, "microsoft": 23, "en": 23, "research": 23, "public": 23, "lenaic": 23, "bernhard": 23, "schmitzer": 23, "fran\u00e7oi": 23, "mai": 23, "1607": 23, "05816": 23, "compris": 24, "new": 24, "__getstate__": 24, "__setstate__": 24, "care": 24, "fname": 26, "pathlib": 26, "path": 26}, "objects": {"fugw.mappings": [[19, 0, 1, "", "FUGW"], [20, 0, 1, "", "FUGWSparse"]], "fugw.mappings.FUGW": [[19, 1, 1, "", "__init__"], [19, 1, 1, "", "fit"], [19, 1, 1, "", "inverse_transform"], [19, 1, 1, "", "transform"]], "fugw.mappings.FUGWSparse": [[20, 1, 1, "", "__init__"], [20, 1, 1, "", "fit"], [20, 1, 1, "", "inverse_transform"], [20, 1, 1, "", "transform"]], "fugw.solvers": [[21, 0, 1, "", "FUGWSolver"], [22, 0, 1, "", "FUGWSparseSolver"]], "fugw.solvers.FUGWSolver": [[21, 1, 1, "", "__init__"], [21, 1, 1, "", "fugw_loss"], [21, 1, 1, "", "get_parameters_uot_l2"], [21, 1, 1, "", "local_biconvex_cost"], [21, 1, 1, "", "solve"]], "fugw.solvers.FUGWSparseSolver": [[22, 1, 1, "", "__init__"], [22, 1, 1, "", "fugw_loss"], [22, 1, 1, "", "local_biconvex_cost"], [22, 1, 1, "", "solve"]]}, "objtypes": {"0": "py:class", "1": "py:method"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"]}, "titleterms": {"basic": [0, 15], "transport": [1, 3], "distribut": [1, 3], "us": [1, 3, 6, 7, 12], "dens": 1, "solver": [1, 3, 21, 22, 23, 25], "comput": [1, 4, 6, 7, 10, 14], "map": [1, 6, 7, 19, 20, 24], "gener": 2, "embed": 2, "from": [2, 16], "mesh": 2, "spars": 3, "time": [4, 10, 14], "brain": [5, 15], "align": [5, 6, 7, 8, 9, 15], "low": [6, 8], "resolut": [6, 7, 8, 9], "surfac": [6, 7], "2": [6, 7, 8, 9], "individu": [6, 7, 8, 9], "fmri": [6, 7, 8, 9], "data": [6, 7, 8, 9], "featur": [6, 7], "arrai": [6, 7], "geometri": [6, 7], "normal": [6, 7], "train": [6, 7], "high": [7, 9], "estim": 7, "kernel": 7, "matric": 7, "volum": [8, 9], "miscellan": [11, 15], "valid": 12, "set": 12, "monitor": [12, 13], "converg": 12, "fugw": [12, 19, 20, 21, 22, 24, 25, 26], "loss": 12, "memori": 13, "usag": 13, "each": 13, "bcd": 13, "iter": 13, "callback": 13, "exampl": 15, "fuse": 16, "unbalanc": 16, "gromov": 16, "wasserstein": 16, "python": 16, "instal": 16, "pypi": 16, "sourc": 16, "cite": 16, "thi": 16, "work": 16, "api": 17, "refer": [17, 23], "contribut": 18, "build": 18, "doc": 18, "fugwspars": 20, "fugwsolv": 21, "fugwsparsesolv": 22, "introduct": 23, "optim": 23, "problem": 23, "util": 26}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 57}, "alltitles": {"Basics": [[0, "basics"], [15, "basics"]], "Transport distributions using dense solvers": [[1, "transport-distributions-using-dense-solvers"]], "Using the computed mapping": [[1, "using-the-computed-mapping"], [6, "using-the-computed-mapping"]], "Generate embeddings from mesh": [[2, "generate-embeddings-from-mesh"]], "Transport distributions using sparse solvers": [[3, "transport-distributions-using-sparse-solvers"]], "Computation times": [[4, "computation-times"], [10, "computation-times"], [14, "computation-times"]], "Brain alignment": [[5, "brain-alignment"], [15, "brain-alignment"]], "Low-resolution surface alignment of 2 individuals with fMRI data": [[6, "low-resolution-surface-alignment-of-2-individuals-with-fmri-data"]], "Computing feature arrays": [[6, "computing-feature-arrays"], [7, "computing-feature-arrays"]], "Computing geometry arrays": [[6, "computing-geometry-arrays"]], "Normalizing features and geometries": [[6, "normalizing-features-and-geometries"], [7, "normalizing-features-and-geometries"]], "Training the mapping": [[6, "training-the-mapping"], [7, "training-the-mapping"]], "High-resolution surface alignment of 2 individuals with fMRI data": [[7, "high-resolution-surface-alignment-of-2-individuals-with-fmri-data"]], "Estimating geometry kernel matrices": [[7, "estimating-geometry-kernel-matrices"]], "Using the computed mappings": [[7, "using-the-computed-mappings"]], "Low-resolution volume alignment of 2 individuals with fMRI data": [[8, "low-resolution-volume-alignment-of-2-individuals-with-fmri-data"]], "High-resolution volume alignment of 2 individuals with fMRI data": [[9, "high-resolution-volume-alignment-of-2-individuals-with-fmri-data"]], "Miscellaneous": [[11, "miscellaneous"], [15, "miscellaneous"]], "Using a validation set to monitor the convergence of the fugw loss": [[12, "using-a-validation-set-to-monitor-the-convergence-of-the-fugw-loss"]], "Monitor memory usage at each BCD iteration with callbacks": [[13, "monitor-memory-usage-at-each-bcd-iteration-with-callbacks"]], "Examples": [[15, "examples"]], "Fused Unbalanced Gromov-Wasserstein for Python": [[16, "fused-unbalanced-gromov-wasserstein-for-python"]], "Installation": [[16, "installation"]], "From PyPI": [[16, "from-pypi"]], "From source": [[16, "from-source"]], "Citing this work": [[16, "citing-this-work"]], "API references": [[17, "api-references"]], "Contributing": [[18, "contributing"]], "Building the docs": [[18, "building-the-docs"]], "fugw.mappings.FUGW": [[19, "fugw-mappings-fugw"]], "fugw.mappings.FUGWSparse": [[20, "fugw-mappings-fugwsparse"]], "fugw.solvers.FUGWSolver": [[21, "fugw-solvers-fugwsolver"]], "fugw.solvers.FUGWSparseSolver": [[22, "fugw-solvers-fugwsparsesolver"]], "Introduction": [[23, "introduction"]], "Optimization problem": [[23, "optimization-problem"]], "Solvers": [[23, "solvers"]], "References": [[23, "references"]], "fugw.mappings": [[24, "fugw-mappings"]], "fugw.solvers": [[25, "fugw-solvers"]], "fugw.utils": [[26, "fugw-utils"]]}, "indexentries": {"fugw (class in fugw.mappings)": [[19, "fugw.mappings.FUGW"]], "__init__() (fugw.mappings.fugw method)": [[19, "fugw.mappings.FUGW.__init__"]], "fit() (fugw.mappings.fugw method)": [[19, "fugw.mappings.FUGW.fit"]], "inverse_transform() (fugw.mappings.fugw method)": [[19, "fugw.mappings.FUGW.inverse_transform"]], "transform() (fugw.mappings.fugw method)": [[19, "fugw.mappings.FUGW.transform"]], "fugwsparse (class in fugw.mappings)": [[20, "fugw.mappings.FUGWSparse"]], "__init__() (fugw.mappings.fugwsparse method)": [[20, "fugw.mappings.FUGWSparse.__init__"]], "fit() (fugw.mappings.fugwsparse method)": [[20, "fugw.mappings.FUGWSparse.fit"]], "inverse_transform() (fugw.mappings.fugwsparse method)": [[20, "fugw.mappings.FUGWSparse.inverse_transform"]], "transform() (fugw.mappings.fugwsparse method)": [[20, "fugw.mappings.FUGWSparse.transform"]], "fugwsolver (class in fugw.solvers)": [[21, "fugw.solvers.FUGWSolver"]], "__init__() (fugw.solvers.fugwsolver method)": [[21, "fugw.solvers.FUGWSolver.__init__"]], "fugw_loss() (fugw.solvers.fugwsolver method)": [[21, "fugw.solvers.FUGWSolver.fugw_loss"]], "get_parameters_uot_l2() (fugw.solvers.fugwsolver method)": [[21, "fugw.solvers.FUGWSolver.get_parameters_uot_l2"]], "local_biconvex_cost() (fugw.solvers.fugwsolver method)": [[21, "fugw.solvers.FUGWSolver.local_biconvex_cost"]], "solve() (fugw.solvers.fugwsolver method)": [[21, "fugw.solvers.FUGWSolver.solve"]], "fugwsparsesolver (class in fugw.solvers)": [[22, "fugw.solvers.FUGWSparseSolver"]], "__init__() (fugw.solvers.fugwsparsesolver method)": [[22, "fugw.solvers.FUGWSparseSolver.__init__"]], "fugw_loss() (fugw.solvers.fugwsparsesolver method)": [[22, "fugw.solvers.FUGWSparseSolver.fugw_loss"]], "local_biconvex_cost() (fugw.solvers.fugwsparsesolver method)": [[22, "fugw.solvers.FUGWSparseSolver.local_biconvex_cost"]], "solve() (fugw.solvers.fugwsparsesolver method)": [[22, "fugw.solvers.FUGWSparseSolver.solve"]]}})